var db=require("../models"),passport=require("../config/passport");module.exports=function(a){a.post("/api/login",passport.authenticate("local"),function(a,b){b.json({email:a.user.email,id:a.user.id})}),a.post("/api/signup",function(a,b){db.User.create({email:a.body.email,password:a.body.password}).then(function(){b.redirect(307,"/api/login")}).catch(function(a){b.status(401).json(a)})}),a.get("/logout",function(a,b){a.logout(),b.redirect("/")}),a.get("/api/user_data",function(a,b){a.user?b.json({email:a.user.email,id:a.user.id}):b.json({})}),a.get("/api/driver/packages",(a,b)=>{a.user.driver?db.Packages.findAll({where:{driverId:a.user.id}}).then(a=>{b.send(a)}):b.json({})}),a.get("/api/packages",(a,b)=>{db.Packages.findAll({}).then(a=>{b.json(a)})}),a.post("/api/packages",(a,b)=>{console.log(a.body),db.Packages.create(a.body).then(a=>{b.json(a)})}),a.post("/my-handling-form-page",(a,b)=>{console.log(a.body),db.Package.create({user_name:a.body.user_name,user_email:a.body.user_email,user_phone:a.body.user_phone,package_description:a.body.user_description,package_dimensions:a.body.user_dimensions,package_weight:a.body.user_weight,pickup_location:a.body.pickup_location,delivery_location:a.body.delivery_location}).then(function(){b.setHeader("Location","/packages")})})};